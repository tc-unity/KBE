<map version="1.0.1"><node CREATED="1652347616584" ID="ID_root" MODIFIED="1652347616584" TEXT="KBEngine"><node CREATED="1652347616584" ID="ID_8738b77c825b" POSITION="right" MODIFIED="1652347616584" TEXT="执行流程"><node CREATED="1652347616584" ID="ID_93cbec92cb0e" MODIFIED="1652347616584" TEXT="Base"><node CREATED="1652347616584" ID="ID_e70b5194f732" MODIFIED="1652347616584" TEXT="调用Kbemain.onBaseAppReady()&amp;lt;br&amp;gt;"><node CREATED="1652347616584" ID="ID_672dfc4f583d" MODIFIED="1652347616584" TEXT="调用createEntityLocally创建FirstSpace实体&amp;lt;br&amp;gt;"></node><node CREATED="1652347616584" ID="ID_4325f2f291c1" MODIFIED="1652347616584" TEXT="createEntityLocally只会创建Entity的Base部分，让人比较难以理解的是FirstSpace对象的base部分在执行基类初始化时自动执行了createEntityInNewSpace的代码，创建了FirstSpace的cell部分实体（简单理解为创建了FirstSpace的Cell部分）&amp;lt;br&amp;gt;"></node></node></node><node CREATED="1652347616584" ID="ID_6c2c302f9e61" MODIFIED="1652347616584" TEXT="cell"><node CREATED="1652347616584" ID="ID_8c28f4d3f2e7" MODIFIED="1652347616584" TEXT="在Space初始化的时候创建并初始化&amp;lt;br&amp;gt;"></node></node></node><node CREATED="1652347616584" ID="ID_28bf97b057ac" POSITION="right" MODIFIED="1652347616584" TEXT="FirstEntity"><node CREATED="1652347616584" ID="ID_4a92f550fbb9" MODIFIED="1652347616584" TEXT="在entities.xml中定义实体&amp;lt;br&amp;gt;"></node><node CREATED="1652347616584" ID="ID_3f2eac1ce86c" MODIFIED="1652347616584" TEXT="在entity_defs创建FirstEntity.def文件&amp;lt;br&amp;gt;"><node CREATED="1652347616584" ID="ID_d92f3accd515" MODIFIED="1652347616584" TEXT="ClientMethods&amp;lt;br&amp;gt;"><node CREATED="1652347616584" ID="ID_4ec622de9afe" MODIFIED="1652347616584" TEXT="&amp;lt;ClientMethods&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;onEnter&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;Arg&amp;gt;UNICODE&amp;lt;/Arg&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;/onEnter&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;onSay&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;Arg&amp;gt;UNICODE&amp;lt;/Arg&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;Arg&amp;gt;INT32&amp;lt;/Arg&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;Arg&amp;gt;UNICODE&amp;lt;/Arg&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;/onSay&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;onCtreatName&amp;nbsp;/&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;lt;/ClientMethods&amp;gt;&amp;lt;br&amp;gt;"></node></node><node CREATED="1652347616584" ID="ID_7f5544291e82" MODIFIED="1652347616584" TEXT="CellMethods"><node CREATED="1652347616584" ID="ID_092e19fd2f90" MODIFIED="1652347616584" TEXT="&amp;lt;CellMethods&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;say&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;Exposed&amp;nbsp;/&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;Arg&amp;gt;UNICODE&amp;lt;/Arg&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;/say&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;CtreatName&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;Exposed&amp;nbsp;/&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;Arg&amp;gt;UNICODE&amp;lt;/Arg&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;/CtreatName&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;lt;/CellMethods&amp;gt;&amp;lt;br&amp;gt;"></node></node><node CREATED="1652347616584" ID="ID_bdf6d73c2b03" MODIFIED="1652347616584" TEXT="Properties"><node CREATED="1652347616584" ID="ID_a4a60bf424fd" MODIFIED="1652347616584" TEXT="&amp;lt;Properties&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;PlayerName&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;Type&amp;gt;UNICODE&amp;lt;/Type&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;Default&amp;gt;null&amp;lt;/Default&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;Flags&amp;gt;CELL_PUBLIC&amp;lt;/Flags&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;Persistent&amp;gt;true&amp;lt;/Persistent&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;/PlayerName&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;lt;/Properties&amp;gt;"></node></node><node CREATED="1652347616584" ID="ID_d3d03b598239" MODIFIED="1652347616584" TEXT="BaseMethids"></node></node><node CREATED="1652347616584" ID="ID_390e3b76bc76" MODIFIED="1652347616584" TEXT="Base&amp;lt;br&amp;gt;"><node CREATED="1652347616584" ID="ID_3817ba685e78" MODIFIED="1652347616584" TEXT="FirstEntity.py"><node CREATED="1652347616584" ID="ID_b554aad9a494" MODIFIED="1652347616584" TEXT="借用Account.py的代码更改类名&amp;nbsp;里面实现了初始化；客户端加入；客户端销毁；&amp;lt;br&amp;gt;"></node><node CREATED="1652347616584" ID="ID_f72eaa2a6b41" MODIFIED="1652347616584" TEXT="在客户端加入时，将对象放入空间"><node CREATED="1652347616584" ID="ID_9e82bde635f5" MODIFIED="1652347616584" TEXT="def&amp;nbsp;onClientEnabled(self):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;KBEngine&amp;nbsp;method.&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;该entity被正式激活为可使用，&amp;nbsp;此时entity已经建立了client对应实体，&amp;nbsp;可以在此创建它的&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;cell部分。&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;INFO_MSG(&amp;quot;account[%i]&amp;nbsp;entities&amp;nbsp;enable.&amp;nbsp;entityCall:%s&amp;quot;&amp;nbsp;%&amp;nbsp;(self.id,&amp;nbsp;self.client))&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;#&amp;nbsp;客户端已经建好链接，将&amp;nbsp;entity加入到space&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;space&amp;nbsp;=&amp;nbsp;KBEngine.globalData[&amp;quot;FirstSpace&amp;quot;]#存的是base部分&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;self.createCellEntity(space.cell)#取得cell部分创建&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;DEBUG_MSG(&amp;quot;将&amp;nbsp;entity加入到space&amp;quot;)"></node></node><node CREATED="1652347616584" ID="ID_d63dac1ba1da" MODIFIED="1652347616584" TEXT="完整代码"><node CREATED="1652347616584" ID="ID_c086b81c9b4d" MODIFIED="1652347616584" TEXT="#&amp;nbsp;-*-&amp;nbsp;coding:&amp;nbsp;utf-8&amp;nbsp;-*-&amp;lt;br&amp;gt;from&amp;nbsp;math&amp;nbsp;import&amp;nbsp;fabs&amp;lt;br&amp;gt;import&amp;nbsp;KBEngine&amp;lt;br&amp;gt;from&amp;nbsp;KBEDebug&amp;nbsp;import&amp;nbsp;*&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;class&amp;nbsp;FirstEntity(KBEngine.Proxy):&amp;lt;br&amp;gt;&amp;nbsp;def&amp;nbsp;__init__(self):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;KBEngine.Proxy.__init__(self)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;def&amp;nbsp;onTimer(self,&amp;nbsp;id,&amp;nbsp;userArg):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;KBEngine&amp;nbsp;method.&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;使用addTimer后，&amp;nbsp;当时间到达则该接口被调用&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;@param&amp;nbsp;id&amp;nbsp;&amp;nbsp;:&amp;nbsp;addTimer&amp;nbsp;的返回值ID&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;@param&amp;nbsp;userArg&amp;nbsp;:&amp;nbsp;addTimer&amp;nbsp;最后一个参数所给入的数据&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;DEBUG_MSG(id,&amp;nbsp;userArg)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;def&amp;nbsp;onClientEnabled(self):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;KBEngine&amp;nbsp;method.&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;该entity被正式激活为可使用，&amp;nbsp;此时entity已经建立了client对应实体，&amp;nbsp;可以在此创建它的&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;cell部分。&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;INFO_MSG(&amp;quot;account[%i]&amp;nbsp;entities&amp;nbsp;enable.&amp;nbsp;entityCall:%s&amp;quot;&amp;nbsp;%&amp;nbsp;(self.id,&amp;nbsp;self.client))&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;#&amp;nbsp;客户端已经建好链接，将&amp;nbsp;entity加入到space&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;space&amp;nbsp;=&amp;nbsp;KBEngine.globalData[&amp;quot;FirstSpace&amp;quot;]#存的是base部分&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;self.createCellEntity(space.cell)#取得cell部分创建&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;DEBUG_MSG(&amp;quot;将&amp;nbsp;entity加入到space&amp;quot;)&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;def&amp;nbsp;onLogOnAttempt(self,&amp;nbsp;ip,&amp;nbsp;port,&amp;nbsp;password):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;KBEngine&amp;nbsp;method.&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;客户端登陆失败时会回调到这里&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;INFO_MSG(ip,&amp;nbsp;port,&amp;nbsp;password)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;return&amp;nbsp;KBEngine.LOG_ON_ACCEPT&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;def&amp;nbsp;onClientDeath(self):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;KBEngine&amp;nbsp;method.&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;客户端对应实体已经销毁&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;DEBUG_MSG(&amp;quot;Account[%i].onClientDeath:&amp;quot;&amp;nbsp;%&amp;nbsp;self.id)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;#self.destroy()&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;self.destroyCellEntity()#销毁CELL&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;def&amp;nbsp;onLoseCell(self):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;DEBUG_MSG(&amp;quot;销毁Base&amp;nbsp;FirstEntuty&amp;quot;)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;self.destroy()&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;"></node></node></node></node><node CREATED="1652347616585" ID="ID_5f20edd3a194" MODIFIED="1652347616585" TEXT="Cell"><node CREATED="1652347616585" ID="ID_114d776a44d3" MODIFIED="1652347616585" TEXT="FirstEntity,py"><node CREATED="1652347616585" ID="ID_a6f6d6642b1e" MODIFIED="1652347616585" TEXT="实现一个 Say方法，发送给所有客户端&amp;lt;br&amp;gt;"><node CREATED="1652347616585" ID="ID_a89777b3d5e9" MODIFIED="1652347616585" TEXT="def&amp;nbsp;say(self,id,content):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if&amp;nbsp;id!=self.id:&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;pass&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#输出信息级别日志&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;INFO_MSG(&amp;quot;Name:%s,Entity:[%d],Content:%s&amp;quot;%(self.PlayerName,id,content))&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;self.otherClients.onSay(self.PlayerName,id,content)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;pass"></node></node><node CREATED="1652347616585" ID="ID_62e36d9ad5a6" MODIFIED="1652347616585" TEXT="初始化方法&amp;nbsp;调用客户端加入服务器方法"><node CREATED="1652347616585" ID="ID_49bb90ddaecc" MODIFIED="1652347616585" TEXT="def&amp;nbsp;__init__(self):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#self.client.onCtreatName()&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if&amp;nbsp;&amp;nbsp;self.PlayerName&amp;nbsp;==&amp;nbsp;&amp;quot;null&amp;quot;&amp;nbsp;:&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;self.client.onCtreatName()&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;else:&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;self.client.onEnter(self.PlayerName)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;INFO_MSG(&amp;quot;Cell&amp;nbsp;:&amp;nbsp;FirstEntity&amp;nbsp;初始化完成！！！&amp;quot;)&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;pass"></node></node><node CREATED="1652347616585" ID="ID_c022ef5bc548" MODIFIED="1652347616585" TEXT="实现方法CtreatName()&amp;lt;br&amp;gt;"><node CREATED="1652347616585" ID="ID_6bf21f1050fc" MODIFIED="1652347616585" TEXT="def&amp;nbsp;CtreatName(self,id,content):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if&amp;nbsp;id!=self.id:&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;pass&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#输出信息级别日志&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;INFO_MSG(&amp;quot;创建用户名:[%d],Content:%s&amp;quot;%(id,content))&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#self.PlayerName&amp;nbsp;=&amp;nbsp;content&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;self.PlayerName&amp;nbsp;=&amp;nbsp;content&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;self.client.onEnter(self.PlayerName)"></node></node><node CREATED="1652347616585" ID="ID_1ee158084790" MODIFIED="1652347616585" TEXT="完整代码"><node CREATED="1652347616585" ID="ID_950e05e7068c" MODIFIED="1652347616585" TEXT="import&amp;nbsp;KBEngine&amp;lt;br&amp;gt;from&amp;nbsp;KBEDebug&amp;nbsp;import&amp;nbsp;*&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;#cell层代码&amp;lt;br&amp;gt;class&amp;nbsp;FirstEntity(KBEngine.Entity):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;def&amp;nbsp;__init__(self):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#self.client.onCtreatName()&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if&amp;nbsp;&amp;nbsp;self.PlayerName&amp;nbsp;==&amp;nbsp;&amp;quot;null&amp;quot;&amp;nbsp;:&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;self.client.onCtreatName()&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;else:&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;self.client.onEnter(self.PlayerName)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;INFO_MSG(&amp;quot;Cell&amp;nbsp;:&amp;nbsp;FirstEntity&amp;nbsp;初始化完成！！！&amp;quot;)&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;pass&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;def&amp;nbsp;say(self,id,content):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if&amp;nbsp;id!=self.id:&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;pass&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#输出信息级别日志&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;INFO_MSG(&amp;quot;Name:%s,Entity:[%d],Content:%s&amp;quot;%(self.PlayerName,id,content))&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;self.otherClients.onSay(self.PlayerName,id,content)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;pass&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;def&amp;nbsp;CtreatName(self,id,content):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if&amp;nbsp;id!=self.id:&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;pass&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#输出信息级别日志&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;INFO_MSG(&amp;quot;创建用户名:[%d],Content:%s&amp;quot;%(id,content))&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;#self.PlayerName&amp;nbsp;=&amp;nbsp;content&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;self.PlayerName&amp;nbsp;=&amp;nbsp;content&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;self.client.onEnter(self.PlayerName)&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;"></node></node></node></node></node><node CREATED="1652347616585" ID="ID_2a21f1a8b2e8" POSITION="right" MODIFIED="1652347616585" TEXT="FirstSpace"><node CREATED="1652347616585" ID="ID_5aff8a9bbcda" MODIFIED="1652347616585" TEXT="在entities.xml中定义实体"></node><node CREATED="1652347616585" ID="ID_cf999e6cc831" MODIFIED="1652347616585" TEXT="在entity_defs创建FirstSpace.def文件"><node CREATED="1652347616585" ID="ID_4e06565315bb" MODIFIED="1652347616585" TEXT="因为空间实体是房间相关，所以只需要保留&amp;nbsp;base和cell"></node></node><node CREATED="1652347616585" ID="ID_b711b6a0d651" MODIFIED="1652347616585" TEXT="Base"><node CREATED="1652347616585" ID="ID_a3208d087d97" MODIFIED="1652347616585" TEXT="FirstSpace.py&amp;lt;br&amp;gt;"><node CREATED="1652347616585" ID="ID_4a4db4b7e487" MODIFIED="1652347616585" TEXT="使用模板代码，修改init方法，并且继承于KBEngine.Space"><node CREATED="1652347616585" ID="ID_3928faf7b2bf" MODIFIED="1652347616585" TEXT="def&amp;nbsp;__init__(self):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;KBEngine.Space.__init__(self)&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;KBEngine.globalData[&amp;nbsp;&amp;quot;FirstSpace&amp;quot;&amp;nbsp;]&amp;nbsp;=&amp;nbsp;self"></node></node></node><node CREATED="1652347616585" ID="ID_6f19b19b5120" MODIFIED="1652347616585" TEXT="完整代码"><node CREATED="1652347616585" ID="ID_e731ff0e249d" MODIFIED="1652347616585" TEXT="#&amp;nbsp;-*-&amp;nbsp;coding:&amp;nbsp;utf-8&amp;nbsp;-*-&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;import&amp;nbsp;KBEngine&amp;lt;br&amp;gt;from&amp;nbsp;KBEDebug&amp;nbsp;import&amp;nbsp;*&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;class&amp;nbsp;FirstSpace(KBEngine.Space):&amp;lt;br&amp;gt;&amp;nbsp;def&amp;nbsp;__init__(self):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;KBEngine.Space.__init__(self)&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;KBEngine.globalData[&amp;quot;FirstSpace&amp;quot;]&amp;nbsp;=&amp;nbsp;self&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;INFO_MSG(&amp;quot;Base服务器创建&amp;nbsp;FirstSpace&amp;nbsp;成功!!!&amp;nbsp;KBEngine.globalData：[%s]&amp;quot;%(KBEngine.globalData[&amp;quot;FirstSpace&amp;quot;]))&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;nbsp;def&amp;nbsp;onTimer(self,&amp;nbsp;id,&amp;nbsp;userArg):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;KBEngine&amp;nbsp;method.&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;使用addTimer后，&amp;nbsp;当时间到达则该接口被调用&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;@param&amp;nbsp;id&amp;nbsp;&amp;nbsp;:&amp;nbsp;addTimer&amp;nbsp;的返回值ID&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;@param&amp;nbsp;userArg&amp;nbsp;:&amp;nbsp;addTimer&amp;nbsp;最后一个参数所给入的数据&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;DEBUG_MSG(id,&amp;nbsp;userArg)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;def&amp;nbsp;onClientEnabled(self):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;KBEngine&amp;nbsp;method.&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;该entity被正式激活为可使用，&amp;nbsp;此时entity已经建立了client对应实体，&amp;nbsp;可以在此创建它的&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;cell部分。&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;INFO_MSG(&amp;quot;account[%i]&amp;nbsp;entities&amp;nbsp;enable.&amp;nbsp;entityCall:%s&amp;quot;&amp;nbsp;%&amp;nbsp;(self.id,&amp;nbsp;self.client))&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;def&amp;nbsp;onLogOnAttempt(self,&amp;nbsp;ip,&amp;nbsp;port,&amp;nbsp;password):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;KBEngine&amp;nbsp;method.&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;客户端登陆失败时会回调到这里&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;INFO_MSG(ip,&amp;nbsp;port,&amp;nbsp;password)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;return&amp;nbsp;KBEngine.LOG_ON_ACCEPT&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;def&amp;nbsp;onClientDeath(self):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;KBEngine&amp;nbsp;method.&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;客户端对应实体已经销毁&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;quot;&amp;quot;&amp;quot;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;DEBUG_MSG(&amp;quot;Account[%i].onClientDeath:&amp;quot;&amp;nbsp;%&amp;nbsp;self.id)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;self.destroy()&amp;lt;br&amp;gt;"></node></node></node><node CREATED="1652347616585" ID="ID_e3d3d8232706" MODIFIED="1652347616585" TEXT="Cell"><node CREATED="1652347616585" ID="ID_82d979bd1c49" MODIFIED="1652347616585" TEXT="FirstSpace.py"><node CREATED="1652347616585" ID="ID_0545c35c9654" MODIFIED="1652347616585" TEXT="继承于KBEngine.Space&amp;nbsp;并初始化"><node CREATED="1652347616585" ID="ID_45989d66ebb2" MODIFIED="1652347616585" TEXT="class&amp;nbsp;FirstSpace(KBEngine.Space):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;def&amp;nbsp;__init__(self):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;KBEngine.Space.__init__(self)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;INFO_MSG(&amp;quot;Cell服务器初始化FirstSpace&amp;nbsp;成功!!!&amp;quot;)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;pass"></node></node></node><node CREATED="1652347616585" ID="ID_f9a7d5832ff5" MODIFIED="1652347616585" TEXT="完整代码"><node CREATED="1652347616585" ID="ID_a8927308dde1" MODIFIED="1652347616585" TEXT="import&amp;nbsp;KBEngine&amp;lt;br&amp;gt;from&amp;nbsp;KBEDebug&amp;nbsp;import&amp;nbsp;*&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;class&amp;nbsp;FirstSpace(KBEngine.Space):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;def&amp;nbsp;__init__(self):&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;KBEngine.Space.__init__(self)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;INFO_MSG(&amp;quot;Cell服务器初始化FirstSpace&amp;nbsp;成功!!!&amp;quot;)&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;pass"></node></node></node></node><node CREATED="1652347616585" ID="ID_fb24a6178c25" POSITION="right" MODIFIED="1652347616585" TEXT="修改gensdk.bat运行&amp;lt;br&amp;gt;"></node><node CREATED="1652347616585" ID="ID_6e68d3ab746e" POSITION="right" MODIFIED="1652347616585" TEXT="UnityClient&amp;lt;br&amp;gt;"><node CREATED="1652347616585" ID="ID_a0485f6657f0" MODIFIED="1652347616585" TEXT="创建FirstEntity.cs继承FirstEntityBase并实现抽象类&amp;lt;br&amp;gt;"><node CREATED="1652347616585" ID="ID_418e606938d3" MODIFIED="1652347616585" TEXT="在成功登录服务器后 onEnter方法中，fireOut,该方法会发送到LoginPanel-&amp;gt;registerout(&amp;quot;OnEnter&amp;quot;)&amp;lt;br&amp;gt;"><node CREATED="1652347616585" ID="ID_e9c6e3730f9e" MODIFIED="1652347616585" TEXT="public&amp;nbsp;override&amp;nbsp;void&amp;nbsp;onEnter()&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;//Dbg.INFO_MSG(&amp;quot;玩家登录到服务器！！！&amp;quot;);&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Debug.Log(&amp;quot;玩家登录到服务器！！！&amp;quot;);&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;KBEngine.Event.fireOut(&amp;quot;onEnter&amp;quot;);&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}"></node></node></node><node CREATED="1652347616585" ID="ID_204618e694ba" MODIFIED="1652347616585" TEXT="创建LoginPanel.cs实现登录,注册，创建昵称，fireIn发送消息到服务器&amp;lt;br&amp;gt;"><node CREATED="1652347616585" ID="ID_cfb674fe98ec" MODIFIED="1652347616585" TEXT="private&amp;nbsp;void&amp;nbsp;OnClickLogin()&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;{&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;KBEngine.Event.fireIn(KBEngine.EventInTypes.login,new&amp;nbsp;object[]&amp;nbsp;{&amp;nbsp;mAccountInput.text,&amp;nbsp;mPasswordInput.text,System.Text.Encoding.UTF8.GetBytes(&amp;quot;登录！！！&amp;quot;)});&amp;lt;br&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}"></node><node CREATED="1652347616585" ID="ID_8bc0959b3876" MODIFIED="1652347616585" TEXT="注册方法registerout（“OnEnter”）用于响应FirstEntity的onEnter方法&amp;lt;br&amp;gt;"><node CREATED="1652347616585" ID="ID_59938176dc65" MODIFIED="1652347616585" TEXT="KBEngine.Event.registerOut(&amp;quot;onEnter&amp;quot;,&amp;nbsp;this,&amp;nbsp;&amp;quot;OnEnter&amp;quot;);"></node></node></node><node CREATED="1652347616585" ID="ID_40a06587b6e0" MODIFIED="1652347616585" TEXT="客服通讯流程：&amp;lt;br&amp;gt;"><node CREATED="1652347616585" ID="ID_04b6d10b6b13" MODIFIED="1652347616585" TEXT="服务器"><node CREATED="1652347616585" ID="ID_b63a8af9a433" MODIFIED="1652347616585" TEXT="收发消息"></node></node><node CREATED="1652347616585" ID="ID_638ef6263091" MODIFIED="1652347616585" TEXT="客户端-&amp;gt;网络&amp;lt;br&amp;gt;"><node CREATED="1652347616585" ID="ID_47872ca50ece" MODIFIED="1652347616585" TEXT="接收服务器消息发给客户端&amp;lt;br&amp;gt;"><node CREATED="1652347616585" ID="ID_c11e6504deaf" MODIFIED="1652347616585" TEXT="registerOut"></node><node CREATED="1652347616585" ID="ID_0191ff17670c" MODIFIED="1652347616585" TEXT="fireOut"></node></node><node CREATED="1652347616585" ID="ID_3153d9d04ff3" MODIFIED="1652347616585" TEXT="接收客户端消息发给服务器"></node></node><node CREATED="1652347616585" ID="ID_f688dba3f61f" MODIFIED="1652347616585" TEXT="客户端"><node CREATED="1652347616585" ID="ID_7b3877eba374" MODIFIED="1652347616585" TEXT="收发客户端网络模块消息&amp;nbsp;"><node CREATED="1652347616585" ID="ID_278a6f2bae31" MODIFIED="1652347616585" TEXT="fireIn"></node><node CREATED="1652347616585" ID="ID_2a51f7638f76" MODIFIED="1652347616585" TEXT="registerIn"></node></node></node></node><node CREATED="1652347616585" ID="ID_b2884af8df42" MODIFIED="1652347616585" TEXT="注意：客户端想要处理服务器发送过来的消息，需要registerout注册接收者&amp;lt;br&amp;gt;"></node></node></node></map>